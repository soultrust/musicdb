services:
  # Django API Backend
  - type: web
    name: soultrust-musicdb-api
    env: python
    plan: free # Change to 'starter' or higher for production
    buildCommand: pip install -r discogs-api/requirements.txt && cd discogs-api && python manage.py collectstatic --noinput
    startCommand: cd discogs-api && gunicorn config.wsgi:application --bind 0.0.0.0:$PORT
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: SECRET_KEY
        sync: false # Set this in Render dashboard
      - key: DEBUG
        value: "False"
      - key: DATABASE_URL
        sync: false # Set this in Render dashboard with your Neon connection string
      - key: DISCOGS_USER_AGENT
        sync: false # Set this in Render dashboard
      - key: DISCOGS_TOKEN
        sync: false # Set this in Render dashboard (optional)
      - key: GEMINI_API_KEY
        sync: false # Set this in Render dashboard (optional)
      - key: SPOTIFY_CLIENT_ID
        sync: false # Set this in Render dashboard (optional)
      - key: SPOTIFY_CLIENT_SECRET
        sync: false # Set this in Render dashboard (optional)
      - key: ALLOWED_HOSTS
        value: soultrust-musicdb-api.onrender.com # Update with your actual Render URL after deployment
      - key: CORS_ALLOW_ALL_ORIGINS
        value: "False"
      - key: CORS_ALLOWED_ORIGINS
        value: https://soultrust-musicdb.onrender.com # Update with your frontend URL after deployment
